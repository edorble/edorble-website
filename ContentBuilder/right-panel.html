<html lang="en-US">
<head>
    <meta charset="utf-8" />
        <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
    <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">

	<link rel="stylesheet" type="text/css" href="css/core.css" />
	<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="js/coherent.js"></script>
	<script type="text/javascript">

		var WorldcodeId = ""; // current worldcode
		var ScreenId = ""; // unique num of the screen in WorldcodeId
		
		// every stored link should have unique id (at least inside the left panel), it filled in this script by unity when user clicks on some link in left panel
	    var Id = ""; // link id
		var Icon = "";
		var Title = "";
		var Description = "";
		
		//receive data for fill in the HTML template
		engine.on("OnReceiveData", function (id, json_string)
		{
			console.log("OnReceiveData " + id + ", json_string " + json_string);		
			if(id==null || id===false)
					return;  // wrong data input
			
			var arr_from_json = JSON.parse( json_string );
			
			Id = id;
		    Icon = arr_from_json[0]; //To be updated to use firebaseJson object. Check order there.
			Title = arr_from_json[1];
			Description = arr_from_json[2];;
			
			console.log( "OnReceiveData " + Id + ", linkIcon " + Icon + ", title " +  Title + ", desc " + Description);
			
			FillInData();
		});

		// fill in data to this HTML template
		function FillInData()
		{
			var obj = $("#icon");
			obj.removeClass();
			obj.addClass(Icon);
		
			$("#title").html(Title);
			$("#description").html(Description);
			
			$("#InfoPanel").show(); // show info, it not displayed by default
		}
		
		// Unity sends there data just after interface is finished loading in Unity
		engine.on("OnBackendReady", function (worldcodeId, regionId, screenId)
		{
			console.log( "OnBackendReady RP: " + worldcodeId + ", screen " + screenId + ", regionId" +  regionId);
			WorldcodeId = worldcodeId;
			ScreenId = screenId;
		});
           $.storage('clear'); //clear coherent cache, needs only during developing
	</script>	
</head>
<body id=InfoPanel width=200 height=512 class=yellow>
<table>
<tr><td id="title" class="myTitle">...</td><td id="icon" class="myIcon"></td></tr>
<tr><td colspan=2>&nbsp;</td></tr>
<tr><td id="description" class="myDescription" colspan=2>...</td></tr>
</table>
</body>
</html>
